# 第2章 Internet地址结构

## 2.1 引言

## 2.2 表示IP地址

- IPv4和IPv6的格式

## 2.3 基本的IP地址结构

### 2.3.1 分类寻址

- IP地址的网络部分和主机部分（主机号和网络号）
- 五类地址空间的划分
- 分类寻址的规模问题
  - 每当新的网段添加到Internet中，不好判断应该为它分配A、B或C类网络号
  - A、B类网络通常主机号过剩，而C类网络通常主机号不足

### 2.3.2 子网寻址

- 解决不易分配网络号的问题
- 把原来的主机号的高位用来做子网号
- 例如，按照分类寻址，分配给某个网段B类网络号，可能浪费主机号，而分配C类网络号可能主机号不够，而现在就可以分配B类网络号，然后网段内自行规定子网号，减少主机号浪费的问题？？？
- 子网号只对网段内部有意义，在外面看见的依然是A、B或C类地址

### 2.3.3 子网掩码

- 高位为1低位为0
- 和该网段的IP地址做按位与运算，就可以得到该网段的子网地址
- 表示格式见表2-5
- 路由表项只保留子网掩码，而不是IP地址，减少表规模

### 2.3.4 可变长度子网掩码

###

### 2.3.5 广播地址

- 主机部分的所有位为1的地址
- 使用这种地址作为目的地的数据报被称为定向广播，会发送给子网中所有的主机
- 有安全问题，目前的RFC规范不支持此功能？？？
- 特殊用途地址255.255.255.255被保留为本地网络广播？？？
- IPv6没有广播地址，仅使用组播地址，第9章

### 2.3.6 IPv6地址和接口标识符

###

## 2.4 CIDR和聚合

- 子网寻址一定程度缓解了不易调度分配网络号的问题
- 规模问题依旧越来越严重
  - B类地址远远不足
  - IPv4地址规模不够
  - 越来越多的A、B、C类路由条目的出现（表变大），影响路由性能
- 解决的思路
  - 要解决问题1和3，需要改进IP地址的分类缺陷，并提高层次化分配的IP地址的聚合能力
  - IPv6设想用于解决问题2

### 2.4.1 前缀

- 和子网寻址的联系和区别
  - CIDR前缀类似于子网寻址的网络号+子网号（子网寻址的前缀）
  - 都是前缀长度不首A、B、C类网络的限制
  - 都需要掩码
  - 前缀表示格式都一样
  - 子网寻址的前缀部分，只有网络号对外部有意义，子网号对于外部是不可见的，也就是说，子网寻址的IP地址，对网段外来说，依旧是一个A、B或C类地址；而CIDR的前缀是可见的

### 2.4.2 聚合

- 任意长度的前缀可以使得IP地址块的大小更灵活
- 没有解决问题3，即减少路由表条目数
- 目前解决的思路都是分层路由
- 减少路由表条目数的方法
  - 将网络拓扑排列为一棵树
    - 需要规定某个子树是负责前缀是什么的这部分IP地址
    - 这是分层路由思想的体现，因为从父节点到子节点，前缀逐渐细化
  - 路由聚合
    - 聚合过程见图2-9
    - 相加？？？

## 2.5 特殊用途地址

- 一些特殊用途的地址范围
  - 表2-7，表2-8
- 没有指定作为特殊、组播或保留地址的地址范围可供单播使用
  - 一些单播地址空间被用于构建专用网络，但是不能跨越全球性的Internet，因此这些地址被称为不可路由的地址/专用地址
  - 那专用地址如何在Internet”存活“？IPv4专用地址经常与网络地址转换（NAT）结合使用，在IP数据报进入Internet时修改Ip地址，第7章讨论NAT

### 2.5.1 IPv4/IPv6地址转换

###

### 2.5.2 组播地址

- 一个IP组播地址标识一组主机接口而非单个接口，也就是说一个IP地址表示一个组
- 在软件的控制下，主机中的协议栈可以加入或离开一个组播组

- 两种组播服务模型
  - 任意源组播（ASM）
    - 任何发送方可以发送给任意组
    - 加入组的接收方被指定唯一的组地址
  - 源特定组播（SSM）
    - 每个组中只使用一个发送方
- 第9章介绍本地IP组播如何工作

### 2.5.3 IPv4组播地址

- D类空间已被保留支持组播
- 表2-9
- ###

### 2.5.4 IPv6组播地址

###

### 2.5.5 任播地址

- 一个任播地址指的是对于这个任播地址“最合适”的一台主机
- 常用于发现了一台提供了常用服务的计算机
  - 例如，某个数据报发送到一个任播地址，可用于找到DNS服务器（第11章）

## 2.6 分配

###

## 2.7 单播地址分配

### 

## 2.8 与IP地址相关的攻击

- “欺骗”数据报，因为IP地址只是暂时的，根据IP地址定位可能出错

